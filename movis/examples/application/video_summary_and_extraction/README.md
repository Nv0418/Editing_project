# Removing margins and adding subtitles to presentation videos

## Motivation

Sharing presentation videos within the company or with a wider audience is crucial for enhancing presence.
However, in practice, these videos often have significant silences between the audio,
making it challenging to grasp the content quickly. Displaying hard-to-understand audio
as subtitles can also aid comprehension.

This sample program detects silent parts of the audio and automatically removes them.
Additionally, it utilizes OpenAIâ€™s Whisper API to automatically transcribe
the audio and incorporate it into the video as subtitles, facilitating a better understanding for non-native speakers.

## How to use

The file ``command.py`` consists of three commands: ``extract``, ``transcribe``, and ``render``.
By executing these commands sequentially, you can produce the final video.
If you wish to modify the style or font of the subtitles, please appropriately alter the source code.

### ``extract``

The ``extract`` command detects silent sections from the given presentation video and outputs the audio,
with the silences removed, in ``.m4a`` format.
It also outputs information about which sections were used as non-silent audio in TSV format.
This information is utilized in the subsequent processes of the ``transcribe`` and ``render`` commands.

```bash
python3 command.py extract -i video.mp4 -o truncated_audio.m4a --region non_silent_regions.tsv
```

### ``transcribe``

The ``transcribe`` command transcribes the audio file and output it as TSV file.
In order to use OpenAI API, please set the ``OPENAI_API_KEY`` environment variable to your API key.

```bash
python3 command.py transcribe -i truncated_audio.m4a -o subtitle.tsv
```

### ``render``

The ``render`` comannd generates the truncated video with subtitles.
It utilizes the information about the non-silent regions and the subtitles generated by the previous commands.

Note that the subtitle file exported by OpenAI contain many errors.
Please check the contents once and correct them accordingly before generating the video.

```bash
python3 command.py render -i video.mp4 -o video_with_subtitle.mp4 --subtitle subtitle.tsv --region non_silent_regions.tsv
```
